<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
    <title>M.O.G. | NATIONAL GRID V70 RESTORED</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        /* -----------------------------------------------------------
           1. V70 CINEMATIC ENGINE
        ----------------------------------------------------------- */
        @import url('https://api.fontshare.com/v2/css?f[]=clash-display@700&f[]=satoshi@400,900&display=swap');
        
        :root { 
            --mog-gold: #D4AF37; --mog-blue: #00d4ff; --mog-bg: #060a0f; 
            --mog-panel: rgba(10, 20, 30, 0.95); --chat-sent: #005c4b; --chat-received: #202c33;
        }

        html, body { height: 100%; margin: 0; background-color: var(--mog-bg); color: var(--mog-gold); display: flex; flex-direction: column; }
        * { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); font-family: 'Satoshi', sans-serif; box-sizing: border-box; }

        body { 
            background-image: 
                linear-gradient(rgba(6, 10, 15, 0.8), rgba(6, 10, 15, 0.8)),
                url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
            background-size: cover; background-attachment: fixed;
        }

        /* -----------------------------------------------------------
           2. V70 NAVIGATION (HAMBURGER)
        ----------------------------------------------------------- */
        #side-drawer { 
            position: fixed; top: 0; left: -100%; width: 320px; height: 100%; 
            background: #0a0e14; z-index: 10000; transition: 0.5s; 
            border-right: 1px solid var(--mog-gold); box-shadow: 20px 0 50px rgba(0,0,0,0.9);
        }
        #side-drawer.drawer-active { left: 0; }
        .drawer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 9999; display: none; backdrop-filter: blur(8px); }
        .drawer-overlay.active { display: block; }
        .drawer-item { padding: 20px 30px; border-bottom: 1px solid rgba(255,255,255,0.03); text-transform: uppercase; font-size: 11px; font-weight: 900; color: #888; display: flex; align-items: center; gap: 15px; cursor: pointer; }
        .drawer-item:hover { color: var(--mog-gold); }

        /* -----------------------------------------------------------
           3. V70 TILES: CINEMATIC MULTIMEDIA
        ----------------------------------------------------------- */
        .mainframe-scroll { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 120px; }
        
        .v70-layout {
            display: grid; gap: 25px;
            grid-template-columns: repeat(12, 1fr);
        }

        .command-tile { 
            background: var(--mog-panel); border: 1px solid rgba(212, 175, 55, 0.2); 
            border-radius: 40px; overflow: hidden; display: flex; flex-direction: column;
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
        }

        /* TILE SIZING - V70 RATIOS */
        .tile-wide { grid-column: span 12; }
        .tile-med { grid-column: span 8; }
        .tile-small { grid-column: span 4; }

        @media (max-width: 1024px) {
            .tile-wide, .tile-med, .tile-small { grid-column: span 12; }
        }

        /* MEDIA SCROLLERS */
        .media-scroller { display: flex; gap: 20px; overflow-x: auto; padding: 10px 0; }
        .media-scroller::-webkit-scrollbar { height: 4px; }
        .media-scroller::-webkit-scrollbar-thumb { background: var(--mog-gold); border-radius: 10px; }

        .v70-card {
            min-width: 280px; height: 380px; background: rgba(255,255,255,0.03); 
            border-radius: 30px; border: 1px solid rgba(255,255,255,0.05);
            display: flex; flex-direction: column; overflow: hidden; position: relative;
        }
        .v70-card img { width: 100%; height: 60%; object-fit: cover; filter: grayscale(50%); }
        .v70-card:hover img { filter: grayscale(0%); transform: scale(1.05); }

        /* -----------------------------------------------------------
           4. V70 FOOTER & HEADER
        ----------------------------------------------------------- */
        header { background: rgba(0,0,0,0.8); backdrop-filter: blur(15px); border-bottom: 1px solid rgba(212, 175, 55, 0.1); }
        footer { background: #000; border-top: 1px solid rgba(255,255,255,0.05); padding: 30px; z-index: 100; }
        .social-link { font-size: 1.4rem; color: #555; transition: 0.4s; }
        .social-link:hover { color: var(--mog-gold); transform: translateY(-5px); }
    </style>
</head>
<body id="mog-mainframe">

    <audio id="log-drum" src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logdrum.mp3" preload="auto"></audio>

    <div id="drawer-overlay" class="drawer-overlay" onclick="toggleDrawer()"></div>
    <nav id="side-drawer">
        <div class="p-10 border-b border-white/5">
            <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-16 w-16 mb-4">
            <p class="text-[10px] text-blue-400 font-black uppercase tracking-widest">Grid Directory</p>
        </div>
        <div class="drawer-item" onclick="location.reload()"><i class="fa-solid fa-house"></i> National Grid</div>
        <div class="drawer-item"><i class="fa-solid fa-compact-disc"></i> Mandate Archive</div>
        <div class="drawer-item"><i class="fa-solid fa-id-badge"></i> ID Matrix</div>
        <div class="drawer-item" onclick="toggleUI('director-console')"><i class="fa-solid fa-shield-halved"></i> Director suite</div>
    </nav>

    <header class="h-[90px] px-8 flex justify-between items-center sticky top-0 z-[500]">
        <div class="flex items-center gap-6">
            <button onclick="toggleDrawer()" class="text-gold text-2xl"><i class="fa-solid fa-bars-staggered"></i></button>
            <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-14 w-14">
            <div>
                <h1 class="text-2xl font-black uppercase italic tracking-tighter text-gold leading-none">Ministry of Groove</h1>
                <p class="text-[11px] text-zinc-500 font-black uppercase italic tracking-[0.2em] mt-1">Decipher the culture.</p>
            </div>
        </div>
        <div class="hidden lg:block text-right">
            <span class="text-[10px] text-blue-400 font-black uppercase tracking-[0.5em] border border-blue-400/20 px-6 py-2 rounded-full">S-01 Mainframe // V70 Restore</span>
        </div>
    </header>

    <div class="mainframe-scroll">
        <div class="v70-layout">
            
            <section class="command-tile tile-wide p-10 bg-gradient-to-r from-gold/10 to-transparent">
                <div class="flex flex-col lg:flex-row justify-between items-center gap-10">
                    <div id="auth-fields" class="w-full lg:w-1/2">
                        <p class="text-[11px] text-gold font-black uppercase mb-6 tracking-widest border-b border-gold/20 pb-2">Authorization Gateway</p>
                        <div class="flex flex-col md:flex-row gap-4">
                            <input id="login-user" type="text" placeholder="OPERATIVE GMAIL" class="flex-grow bg-white/5 border border-white/10 rounded-2xl p-5 text-white outline-none">
                            <input id="login-pass" type="password" placeholder="PASSCODE" class="flex-grow bg-white/5 border border-white/10 rounded-2xl p-5 text-white outline-none">
                        </div>
                        <button onclick="handleMainAuth()" class="w-full bg-white text-black font-black py-5 rounded-full mt-6 uppercase text-xs tracking-widest">Authorize Identity</button>
                    </div>
                    
                    <div id="active-op-badge" class="hidden w-full lg:w-1/2 text-center border-l border-white/5 pl-10">
                        <p class="text-[10px] text-gold font-black uppercase tracking-widest mb-2">Authenticated Operative</p>
                        <h2 id="display-op-id" class="text-5xl text-white font-black uppercase italic tracking-tighter">OPERATIVE</h2>
                        <button onclick="logout()" class="text-[10px] text-red-500 font-black uppercase mt-8 border border-red-500/20 px-6 py-2 rounded-full">Terminate Frequency</button>
                    </div>

                    <div class="hidden lg:block text-right">
                        <p class="text-3xl font-black italic uppercase text-white/10">S-01 Sector</p>
                        <p class="text-gold font-black uppercase text-sm mt-2">Witbank HQ</p>
                    </div>
                </div>
            </section>

            <section class="command-tile tile-wide p-10">
                <div class="flex justify-between items-center mb-10">
                    <h3 class="text-white font-black uppercase italic text-lg tracking-tighter">Mandate Mix Archive</h3>
                    <audio id="v70-player" controls class="h-10 w-64"></audio>
                </div>
                <div class="media-scroller">
                    <div class="v70-card group">
                        <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="p-10 bg-black/40">
                        <div class="p-6">
                            <p class="text-[10px] text-gold font-black uppercase">Session 002</p>
                            <h4 class="text-white font-black uppercase text-xl mt-1">Mandate Blueprint</h4>
                            <button onclick="playMix('mandatemix.mp3')" class="mt-6 text-[10px] bg-white text-black font-black px-8 py-3 rounded-full uppercase">Play Frequency</button>
                        </div>
                    </div>
                    <div class="v70-card opacity-30">
                        <div class="flex items-center justify-center h-full"><i class="fa-solid fa-lock text-4xl"></i></div>
                    </div>
                </div>
            </section>
            
            <section class="command-tile tile-med p-1 bg-[#0b141a]">
                <div class="flex flex-col h-[500px]">
                    <div id="chat-stream" class="flex-grow p-8 overflow-y-auto space-y-4"></div>
                    <div class="p-6 bg-[#202c33] flex gap-4">
                        <input id="chat-msg" type="text" placeholder="Broadcast message..." class="flex-grow bg-[#2a3942] border-0 rounded-full px-8 py-4 text-white text-sm outline-none">
                        <button onclick="sendMessage()" class="w-16 h-16 bg-blue-500 text-black rounded-full flex items-center justify-center shadow-xl shadow-blue-500/20"><i class="fa-solid fa-paper-plane"></i></button>
                    </div>
                </div>
            </section>

            <section class="command-tile tile-small p-8">
                <p class="text-[11px] text-white font-black uppercase mb-8 border-b border-white/5 pb-2 italic">Hitlist status</p>
                <div id="hitlist-v70" class="space-y-4">
                    </div>
                <div class="mt-auto">
                    <iframe src="http://googleusercontent.com/spotify.com/7" width="100%" height="80" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
                </div>
            </section>

        </div>
    </div>

    <footer class="flex flex-col md:flex-row justify-between items-center gap-10">
        <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-10 grayscale opacity-40">
        <div class="flex gap-10">
            <a href="https://tiktok.com/@directormog" target="_blank" class="social-link"><i class="fa-brands fa-tiktok"></i></a>
            <a href="https://instagram.com" target="_blank" class="social-link"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://wa.me/27791438964" target="_blank" class="social-link"><i class="fa-brands fa-whatsapp"></i></a>
            <a href="https://youtube.com" target="_blank" class="social-link"><i class="fa-brands fa-youtube"></i></a>
        </div>
        <p class="text-[10px] text-zinc-700 font-black uppercase tracking-[0.5em]">Â© 2026 MINISTRY OF GROOVE // WITBANK HQ</p>
    </footer>

    <div id="director-console" style="display:none;" class="fixed inset-0 z-[20000] bg-black/98 flex items-center justify-center p-6">
        <div class="command-tile p-12 max-w-2xl w-full border-gold/40">
            <h2 class="text-3xl text-white font-black uppercase italic mb-8 border-b border-white/5 pb-4">Director Suite</h2>
            <button onclick="operativePulse()" class="w-full bg-blue-500 text-black font-black p-6 rounded-full uppercase text-xs mb-4">Pulse National Grid</button>
            <button onclick="toggleUI('director-console')" class="w-full bg-white/5 text-white font-black p-6 rounded-full uppercase text-xs">Terminate Console</button>
        </div>
    </div>

    <script>
        const MOG_CFG = {
            U: "https://vbkpatwvgvwarybbpiky.supabase.co",
            K: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZia3BhdHd2Z3Z3YXJpYmJwaWt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExMjc0MTksImV4cCI6MjA4NjcwMzQxOX0.v3iWw2z9vL-X6pGjY0W_S5m1z0S8uI1L8yN7fL0M_Y8"
        };
        const db = window.supabase.createClient(MOG_CFG.U, MOG_CFG.K);
        let currentOp = null, logoClicks = 0;

        function toggleDrawer() {
            document.getElementById('side-drawer').classList.toggle('drawer-active');
            document.getElementById('drawer-overlay').classList.toggle('active');
        }

        function toggleUI(id) { 
            const el = document.getElementById(id);
            el.style.display = el.style.display === 'none' ? 'flex' : 'none'; 
        }

        function playMix(file) {
            const player = document.getElementById('v70-player');
            player.src = `https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/${file}`;
            player.play();
        }

        async function operativePulse() {
            document.body.style.opacity = '0.5';
            document.getElementById('log-drum').play();
            setTimeout(() => document.body.style.opacity = '1', 400);
        }

        /* SUPABASE REALTIME */
        const channel = db.channel('public:messages')
            .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'messages' }, (payload) => {
                document.getElementById('log-drum').currentTime = 0;
                document.getElementById('log-drum').play().catch(() => {});
                appendMsg(payload.new); 
            }).subscribe();

        function appendMsg(m) {
            const stream = document.getElementById('chat-stream');
            const div = document.createElement('div');
            div.className = `bubble ${m.user_id === currentOp?.id ? 'sent' : 'received'}`;
            div.innerHTML = `<span class="text-[9px] font-black uppercase block mb-1 text-gold">@${m.alias}</span>${m.content}`;
            stream.appendChild(div);
            stream.scrollTop = stream.scrollHeight;
        }

        async function handleMainAuth() {
            const email = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value;
            const { data, error } = await db.auth.signInWithPassword({ 
                email: email.includes('@') ? email : `${email}@user.mog.internal`, 
                password: pass 
            });
            if(!error) { 
                currentOp = data.user; 
                document.getElementById('auth-fields').classList.add('hidden');
                document.getElementById('active-op-badge').classList.remove('hidden');
                const { data: reg } = await db.from('registrations').select('alias').eq('user_id', currentOp.id).single();
                if(reg) document.getElementById('display-op-id').innerText = reg.alias;
            } else { alert(error.message); }
        }

        document.getElementById('mog-logo-trigger').addEventListener('click', () => {
            if (++logoClicks === 5) { toggleUI('director-console'); logoClicks = 0; }
            setTimeout(() => logoClicks = 0, 5000);
        });

        window.onload = () => {
             const hit = document.getElementById('hitlist-v70');
             for(let i=1; i<=10; i++) {
                 hit.innerHTML += `<div class="flex justify-between items-center bg-white/5 p-3 rounded-2xl border border-white/5"><p class="text-[10px] text-white font-black uppercase">HIT_RANK_${i}</p><i class="fa-brands fa-spotify text-green-500"></i></div>`;
             }
        };
    </script>
</body>
</html>
