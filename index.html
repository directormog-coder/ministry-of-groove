<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
    <title>M.O.G. | NATIONAL AMAPIANO GRID V56.3.0</title>
    
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        @import url('https://api.fontshare.com/v2/css?f[]=clash-display@700&f[]=satoshi@400,900&display=swap');
        :root { --mog-gold: #D4AF37; --mog-blue: #00d4ff; --mog-bg: #060a0f; --mog-panel: rgba(10, 20, 30, 0.95); --wa-bg: #0b141a; }
        
        * { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); font-family: 'Satoshi', sans-serif; -webkit-tap-highlight-color: transparent; }
        h1, .tile-title { font-family: 'Clash Display', sans-serif; }
        .brand-title { font-size: clamp(1.5rem, 8vw, 3rem); line-height: 1.1; }

        /* MOTHERBOARD CIRCUIT PATTERN */
        body { 
            background-color: var(--mog-bg); 
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 85%),
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 10 L30 10 L30 30 M70 10 L90 10 L90 30 M10 90 L10 70 L30 70 M90 90 L90 70 L70 70 M30 30 L50 30 L50 50 L70 50 L70 70' stroke='%2300d4ff' stroke-width='0.5' fill='none' opacity='0.2'/%3E%3C/svg%3E");
            background-attachment: fixed;
            color: var(--mog-gold); margin: 0; overflow-x: hidden;
        }

        #ticker-wrap { position: fixed; top: 0; width: 100%; background: #000; border-bottom: 1px solid var(--mog-gold); z-index: 1000; height: 35px; display: flex; align-items: center; overflow: hidden; -webkit-mask-image: linear-gradient(to right, black 75%, transparent 100%); mask-image: linear-gradient(to right, black 75%, transparent 100%); }
        .ticker-move { display: inline-block; white-space: nowrap; animation: ticker 45s linear infinite; font-size: 9px; font-weight: 900; letter-spacing: 2.5px; color: var(--mog-gold); text-transform: uppercase; }
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        /* INCENTIVE CARDS */
        .incentive-card { background: rgba(0, 212, 255, 0.05); border: 1px solid rgba(0, 212, 255, 0.1); padding: 12px; border-radius: 12px; margin-bottom: 8px; }
        .phase-row { padding: 12px; border-radius: 12px; background: rgba(255,255,255,0.03); border: 1px solid rgba(0, 212, 255, 0.1); margin-bottom: 10px; }
        .phase-active { border-color: var(--mog-gold); background: rgba(212, 175, 55, 0.05); }

        .scroller-v { overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--mog-blue) transparent; }
        .scroller-v::-webkit-scrollbar { width: 6px; }
        .scroller-v::-webkit-scrollbar-thumb { background: linear-gradient(var(--mog-blue), #005c4b); border-radius: 10px; }

        .director-only { display: none; }
        .director-active .director-only { display: block; }
        
        #app-content { margin-top: 80px; padding: 20px; }
        .command-tile { background: var(--mog-panel); border: 1px solid rgba(0, 212, 255, 0.3); backdrop-filter: blur(40px); border-radius: 28px; overflow: hidden; position: relative; }
        .tile-header { border-bottom: 1px solid rgba(0, 212, 255, 0.2); padding: 18px 24px; background: linear-gradient(90deg, rgba(0, 212, 255, 0.1) 0%, transparent 100%); }
    </style>
</head>
<body class="scrollbar-hide" id="main-body">

    <button onclick="toggleMenu()" class="fixed top-10 left-6 z-[2500] text-blue-400 text-2xl"><i class="fa-solid fa-bars-staggered"></i></button>
    
    <nav id="side-menu" class="fixed top-0 left-[-320px] w-[320px] h-full bg-[#080c10] border-right border-white/5 p-8 z-[3000] transition-all">
        <div class="mb-10 flex items-center gap-4"><img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-12 w-12"><span class="text-gold font-black text-xs uppercase italic">Folders</span></div>
        <div class="space-y-4">
            <div class="flex justify-between items-center bg-white/5 p-4 rounded-xl"><span class="text-[10px] uppercase font-black text-zinc-400">Silent Mode</span><input type="checkbox" id="silent-toggle" class="accent-emerald-500"></div>
            <a class="block p-4 text-white uppercase text-[11px] border-b border-white/5">Grid Architecture</a>
            <a class="block p-4 text-white uppercase text-[11px] border-b border-white/5">Privacy Protocol</a>
        </div>
    </nav>

    <div id="ticker-wrap"><div class="ticker-move">INCENTIVE_PROTOCOLS_V56.3 // RECRUIT_AND_EARN // PHASE_2_FAST_TRACK // TARGET_500_OPERATIVES // DIRECTOR_ONLINE...</div></div>

    <div id="app-content" class="opacity-1">
        <header class="flex flex-col lg:flex-row justify-between items-center gap-10 relative z-50 mb-10 pl-16 lg:pl-0">
            <div class="flex items-center gap-8 w-full">
                <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-[82px] w-[82px] border-2 border-blue-500/50 rounded-full shadow-2xl">
                <div class="w-full">
                    <h1 class="brand-title text-[#D4AF37] tracking-[.25em] uppercase font-black">Ministry of Groove</h1>
                    <div class="flex items-center gap-4 mt-2">
                        <p class="text-[10px] text-blue-400 tracking-[.6em] uppercase font-black">Decrypting the Culture. Synchronizing the Grid.</p>
                        <div class="flex items-center gap-2 bg-black/40 px-3 py-1 rounded-full border border-white/5">
                            <span id="lat-dot" class="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_8px_#22c55e]"></span>
                            <span id="lat-val" class="text-[9px] text-zinc-500 font-black uppercase">LATENCY: 24ms</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex flex-col items-end text-right">
                <div class="text-[11px] text-white font-black bg-emerald-500/20 px-6 py-2 rounded-full border border-emerald-500/30 uppercase italic">Phase 1: Recruitment</div>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-10 relative z-50">
            
            <div class="lg:col-span-4 space-y-10">
                <section class="command-tile p-8">
                    <div id="auth-ui" class="space-y-4">
                        <input id="email-in" type="email" placeholder="ACCESS EMAIL" class="w-full bg-black/40 border border-blue-500/20 rounded-xl p-4 text-white text-[10px] outline-none">
                        <input id="pass-in" type="password" placeholder="DIRECTOR CODE" class="w-full bg-black/40 border border-gold/20 rounded-xl p-4 text-gold text-[10px] outline-none hidden">
                        <div class="grid grid-cols-2 gap-4"><button onclick="handleAuth()" class="border border-blue-400/30 p-3 rounded-xl text-[10px] font-bold">Login</button><button onclick="handleAuth()" class="border border-gold/30 p-3 rounded-xl text-[10px] font-bold">Signup</button></div>
                    </div>
                </section>

                <section class="command-tile p-8 space-y-6 border-gold/40">
                    <div class="tile-header flex justify-between px-0"><span class="tile-title text-gold uppercase">Phase 2 Fast-Track</span><i class="fa-solid fa-bolt-lightning text-gold animate-pulse"></i></div>
                    
                    <div class="scroller-v max-h-[400px] pr-2">
                        <p class="text-[10px] text-zinc-400 mb-4 uppercase font-black tracking-widest">How to earn early access:</p>
                        
                        <div class="incentive-card">
                            <div class="flex justify-between items-center"><span class="text-[10px] text-blue-400 font-black uppercase">Recruitment Link</span><span class="text-[9px] text-gold">+5 Points</span></div>
                            <p class="text-[9px] text-zinc-300 mt-2 italic">Share your unique grid link. Every 10 operatives recruited = Immediate Phase 2 Handshake.</p>
                            <button class="w-full bg-blue-500/20 border border-blue-400 text-[9px] py-2 rounded-lg mt-3 uppercase font-black">Copy Signal Link</button>
                        </div>

                        <div class="incentive-card">
                            <div class="flex justify-between items-center"><span class="text-[10px] text-blue-400 font-black uppercase">Content Curator</span><span class="text-[9px] text-gold">+3 Points</span></div>
                            <p class="text-[9px] text-zinc-300 mt-2 italic">Submit verified Amapiano hits to the Frequency Grid. Most voted tracks earn Early-Access tokens.</p>
                        </div>

                        <div class="incentive-card">
                            <div class="flex justify-between items-center"><span class="text-[10px] text-blue-400 font-black uppercase">Grid Sentinel</span><span class="text-[9px] text-gold">+2 Points</span></div>
                            <p class="text-[9px] text-zinc-300 mt-2 italic">Daily login and Frequency Chat engagement keeps your signal high for the Phase 2 queue.</p>
                        </div>
                    </div>

                    <div class="phase-row phase-active">
                        <div class="flex justify-between text-[10px] font-black"><span class="text-white">GRID PROGRESS: 142 / 500</span><span class="text-gold">28%</span></div>
                        <div class="w-full bg-white/5 h-1.5 rounded-full mt-2"><div class="bg-gold h-full rounded-full shadow-[0_0_10px_#D4AF37]" style="width: 28%"></div></div>
                    </div>
                </section>

                <section class="command-tile border-blue-500/40">
                    <div class="tile-header flex justify-between"><span class="tile-title text-blue-500">National Territorial Radar</span><i class="fa-solid fa-satellite-dish animate-pulse"></i></div>
                    <div class="h-64"><iframe class="w-full h-full grayscale invert opacity-50 contrast-150 border-none scale-110" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14348.66779083556!2d29.2014842!3d-25.872715!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1e9d123456789abc%3A0x1234567890abcdef!2seMalahleni!5e0!3m2!1sen!2sza!4v1620000000000!5m2!1sen!2sza6"></iframe></div>
                </section>
            </div>

            <div class="lg:col-span-8 space-y-10">
                <section class="command-tile border-blue-500/20 h-[500px] flex flex-col">
                    <div class="tile-header flex justify-between px-6 py-5"><span class="tile-title text-blue-400 font-black">Visual Intel Archive</span><i class="fa-solid fa-shield-halved text-blue-400"></i></div>
                    <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-3 gap-6 p-6 flex-grow scroller-v"></div>
                </section>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                    <section class="command-tile h-[650px] flex flex-col">
                        <div class="tile-header flex justify-between items-center"><span class="tile-title text-[#1DB954]">Spotify Hitlist</span><i class="fa-brands fa-spotify text-2xl text-[#1DB954]"></i></div>
                        <div class="flex-grow scroller-v p-2">
                            <iframe style="border-radius:18px" src="https://open.spotify.com/embed/playlist/37i9dQZEVXbO789QXCHY7F?utm_source=generator&theme=0" width="100%" height="900" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                        </div>
                    </section>

                    <section class="command-tile h-[650px] flex flex-col" style="background: var(--wa-bg);">
                        <div class="tile-header bg-[#202c33] flex items-center gap-4 py-3 px-6 shadow-xl"><p class="text-white font-black text-sm uppercase">M.O.G. Comms</p></div>
                        <div id="chat-stream" class="flex-grow p-6 scroller-v flex flex-col" style="background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-blend-mode: overlay;"></div>
                        <div class="p-4 bg-[#202c33] flex items-center gap-4">
                            <input type="text" id="chat-msg-in" placeholder="Message..." class="flex-grow bg-[#2a3942] rounded-full px-6 py-3 text-white text-sm outline-none">
                            <button onclick="sendPacket()" class="bg-[#00a884] text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg"><i class="fa-solid fa-paper-plane"></i></button>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>
    
    <section id="director-dashboard" class="hidden fixed inset-0 z-[3000] bg-black/98 p-10 overflow-y-auto scroller-v">
        <div class="flex justify-between items-center mb-12 border-b border-gold/30 pb-4"><h2 class="text-3xl text-white font-black uppercase">Director Command</h2><button onclick="toggleDirectorUI()" class="text-white text-2xl"><i class="fa-solid fa-xmark"></i></button></div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto director-only">
            <div class="command-tile p-8 space-y-4"><h3 class="tile-title text-gold italic">Intel Upload</h3><input type="file" onchange="uploadIntel(this)"></div>
            <div class="command-tile p-8 space-y-4"><h3 class="tile-title text-gold italic">MP3 Inject</h3><input type="file" onchange="uploadArchive(this)"></div>
        </div>
    </section>

    <button id="admin-trigger" class="hidden fixed bottom-12 right-12 z-[2500] bg-gold text-black w-16 h-16 rounded-full flex items-center justify-center animate-bounce shadow-2xl" onclick="toggleDirectorUI()"><i class="fa-solid fa-crown text-xl"></i></button>

    <script>
        const CFG = { U: "https://vbkpatwvgvwarybbpiky.supabase.co", K: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZia3BhdHd2Z3Z3YXJpYmJwaWt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExMjc0MTksImV4cCI6MjA4NjcwMzQxOX0.v3iWw2z9vL-X6pGjY0W_S5m1z0S8uI1L8yN7fL0M_Y8" };
        const db = window.supabase.createClient(CFG.U, CFG.K);
        let currentUser = null;
        let lastArchiveCount = 0;
        const notifySound = new Audio("https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/notification.mp3");

        function toggleMenu() { document.getElementById('side-menu').style.left = document.getElementById('side-menu').style.left === '0px' ? '-320px' : '0px'; }
        function showDirectorLogin() { document.getElementById('pass-in').classList.toggle('hidden'); }
        function toggleDirectorUI() { document.getElementById('director-dashboard').classList.toggle('hidden'); }
        
        async function handleAuth() {
            const email = document.getElementById('email-in').value.toLowerCase();
            const pass = document.getElementById('pass-in').value;
            if (email === 'director.mog@gmail.com' && (pass === '7486' || pass === '@MOGProtocol2026')) {
                currentUser = { id: 'DIRECTOR', email };
                document.getElementById('main-body').classList.add('director-active');
                document.getElementById('auth-ui').classList.add('hidden');
                document.getElementById('admin-trigger').classList.remove('hidden');
                fetchGallery(); fetchArchive(); fetchMessages();
            }
        }

        async function fetchArchive() {
            const { data } = await db.storage.from('archive').list('public');
            if (data) {
                const isSilent = document.getElementById('silent-toggle').checked;
                if (lastArchiveCount > 0 && data.length > lastArchiveCount && !isSilent) notifySound.play().catch(() => {});
                lastArchiveCount = data.length;
            }
        }

        async function fetchGallery() {
            const { data } = await db.storage.from('gallery').list('public');
            if (data) document.getElementById('gallery-grid').innerHTML = data.map(f => {
                const { data: { publicUrl } } = db.storage.from('gallery').getPublicUrl(`public/${f.name}`);
                return `<div class="h-48 overflow-hidden rounded-2xl border border-white/10 relative"><img src="${publicUrl}" class="w-full h-full object-cover opacity-80"></div>`;
            }).join('');
        }

        async function fetchMessages() { const { data } = await db.from('messages').select('*').order('created_at', { ascending: true }); if (data) data.forEach(displayMessage); }
        function displayMessage(m) {
            const s = document.getElementById('chat-stream');
            const d = document.createElement('div');
            const isMe = m.alias === 'DIRECTOR_MOG';
            d.className = `wa-bubble ${isMe ? 'wa-out' : 'wa-in'}`;
            d.innerHTML = `<p class="font-black text-[10px] ${isMe ? 'text-zinc-200' : 'text-blue-400'} mb-1">${m.alias || 'OPERATIVE'}</p><p>${m.content}</p>`;
            s.appendChild(d); s.scrollTop = s.scrollHeight;
        }

        async function sendPacket() {
            const i = document.getElementById('chat-msg-in'); if(!i.value || !currentUser) return;
            const alias = currentUser.email === 'director.mog@gmail.com' ? 'DIRECTOR_MOG' : currentUser.email.split('@')[0];
            await db.from('messages').insert([{ content: i.value, user_id: currentUser.id, alias: alias }]); i.value = "";
        }

        window.addEventListener('load', () => { 
            fetchGallery(); fetchArchive(); setInterval(fetchArchive, 10000); 
            setInterval(() => {
                const lat = Math.floor(Math.random() * 20) + 15;
                document.getElementById('lat-val').innerText = `LATENCY: ${lat}ms`;
            }, 3000);
        });
    </script>
</body>
</html>
