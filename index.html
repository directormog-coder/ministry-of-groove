<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
    <meta name="description" content="Ministry of Groove: Decrypting the Culture. Synchronizing the Grid.">
    <title>M.O.G. | NATIONAL AMAPIANO GRID V70.0.1</title>
    
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#060a0f">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        @import url('https://api.fontshare.com/v2/css?f[]=clash-display@700&f[]=satoshi@400,900&display=swap');
        :root { --mog-gold: #D4AF37; --mog-blue: #00d4ff; --mog-bg: #060a0f; --mog-panel: rgba(10, 20, 30, 0.95); }
        
        * { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); font-family: 'Satoshi', sans-serif; -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        h1, .tile-title { font-family: 'Clash Display', sans-serif; }
        
        body { 
            background-color: var(--mog-bg); 
            background-image: radial-gradient(circle at 50% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 85%);
            background-attachment: fixed;
            color: var(--mog-gold); margin: 0; overflow-x: hidden;
            width: 100vw; min-height: 100vh;
        }

        .director-active body { animation: goldPulse 4s infinite alternate ease-in-out; }
        @keyframes goldPulse { from { filter: brightness(1); } to { filter: brightness(1.25); } }

        .command-tile { 
            background: var(--mog-panel); 
            border: 1px solid rgba(0, 212, 255, 0.2); 
            backdrop-filter: blur(30px); 
            border-radius: 28px; 
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8);
        }

        #side-menu { 
            position: fixed; top: 0; right: -320px; 
            width: 320px; height: 100%; 
            background: #080c10; border-left: 1px solid rgba(0,212,255,0.2); 
            z-index: 3000; padding: 2.5rem; 
            transition: 0.6s cubic-bezier(0.19, 1, 0.22, 1); 
        }
        #side-menu.active { right: 0; }
        .nav-link { display: block; padding: 12px 16px; background: rgba(255,255,255,0.02); border-radius: 10px; font-size: 10px; font-weight: 900; text-transform: uppercase; margin-bottom: 8px; color: white; }

        .radar-container { filter: grayscale(1) invert(1) contrast(1.2) brightness(0.7) hue-rotate(180deg); opacity: 0.6; pointer-events: none; }
        
        .mog-chat-row { display: flex; gap: 10px; margin-bottom: 15px; align-items: flex-end; }
        .mog-bubble { padding: 10px 15px; border-radius: 18px; font-size: 13px; color: #fff; background: rgba(0, 212, 255, 0.05); border: 1px solid rgba(0, 212, 255, 0.15); max-width: 85%; }

        .scroller-v { overflow-y: auto; scrollbar-width: thin; }
        .director-only { display: none !important; }
        .director-active .director-only { display: block !important; }

        #directive-modal { background: rgba(6, 10, 15, 0.98); backdrop-filter: blur(20px); }
        .countdown-box { background: rgba(212, 175, 55, 0.1); border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 15px; padding: 15px; text-align: center; }
    </style>
</head>
<body class="scrollbar-hide">

    <div id="startup-overlay" class="fixed inset-0 z-[9999] bg-[#060a0f] flex flex-col items-center justify-center transition-opacity duration-1000">
        <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" class="h-32 w-32 animate-pulse mb-4">
        <div class="text-gold font-black uppercase tracking-[0.5em] text-[10px]">Synchronizing Grid...</div>
    </div>

    <div id="ticker-wrap" class="fixed top-0 w-full bg-black z-[1000] h-[35px] border-b border-gold flex items-center overflow-hidden">
        <div class="ticker-move text-[9px] font-black uppercase text-gold">MASTER_V70.0.1 // PHASE_2_PREPARATION_IN_PROGRESS // DIRECTIVE_ACTIVE // eMALAHLENI_SYNC...</div>
    </div>

    <button onclick="toggleMenu()" class="fixed top-12 right-5 z-[2500] text-blue-400 text-2xl p-2 bg-black/40 rounded-full border border-white/5 backdrop-blur-md">
        <i class="fa-solid fa-bars-staggered"></i>
    </button>
    
    <nav id="side-menu" class="scroller-v">
        <div class="flex justify-between items-center mb-6">
            <span class="text-gold font-black uppercase text-xs tracking-widest italic">Sovereign Folders</span>
            <button onclick="toggleMenu()"><i class="fa-solid fa-xmark text-xl text-zinc-500"></i></button>
        </div>

        <div class="countdown-box mb-8">
            <span class="text-[8px] font-black text-gold uppercase tracking-[0.3em]">Phase 2 Expansion</span>
            <div id="timer" class="text-xl font-black text-white my-2 tabular-nums">00:00:00:00</div>
            <p class="text-[7px] text-zinc-500 uppercase">Neural Archive Handshake</p>
        </div>

        <span class="text-[8px] font-black text-blue-400 uppercase tracking-widest mb-4 block opacity-60">Protocols</span>
        <a href="javascript:void(0)" onclick="openDirective()" class="nav-link"><i class="fa-solid fa-scroll mr-2 text-gold"></i> Grid Directives</a>
        <div class="p-4 bg-white/5 rounded-xl border border-white/10 mt-4">
            <span class="text-[9px] uppercase font-black text-zinc-400">Silent Browsing</span>
            <input type="checkbox" id="silent-toggle" class="float-right accent-gold">
        </div>
    </nav>

    <div id="directive-modal" class="fixed inset-0 z-[6000] hidden flex items-center justify-center p-6">
        <div class="command-tile max-w-2xl w-full max-h-[80vh] flex flex-col p-8 border-gold/40">
            <h2 class="text-2xl font-black text-gold mb-4 uppercase italic">Grid Directives</h2>
            <div class="scroller-v text-[11px] text-zinc-300 space-y-4 pr-4">
                <p><strong>1. DATA DECRYPTION:</strong> Operatives acknowledge that all data transmitted within the Grid is encrypted.</p>
                <p><strong>2. SOVEREIGN PRIVACY:</strong> Personal Gmail identifiers are used solely for Neural Handshake (Auth).</p>
                <p><strong>3. NOISE REDUCTION:</strong> Any signal found injecting "noise" will be terminated by the Director.</p>
                <p><strong>4. PHASES:</strong> Access to the Sovereign Archive (Phase 2) is earned. 500 signals required.</p>
            </div>
            <button onclick="closeDirective()" class="mt-6 bg-gold text-black font-black py-3 rounded-full uppercase text-[10px]">Understood</button>
        </div>
    </div>

    <div id="app-content" class="container mx-auto px-4 mt-[60px]">
        <header class="flex items-center gap-6 mb-12 pt-4">
            <img src="https://raw.githubusercontent.com/directormog-coder/Ministry-of-Groove/main/logo.png" onclick="handleLogoSequence()" class="h-16 w-16 md:h-24 md:w-24 cursor-pointer">
            <div class="min-w-0 flex-grow">
                <h1 class="brand-title text-[#D4AF37] uppercase font-black truncate">Ministry of Groove</h1>
                <p class="grid-subtext text-blue-400 uppercase font-black">Decrypting the Culture. Synchronizing the Grid.</p>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-8 pb-12">
            
            <div class="lg:col-span-4 space-y-8">
                <section class="command-tile p-8 bg-black/60">
                    <div id="auth-ui" class="space-y-4">
                        <input id="login-user" type="text" placeholder="GMAIL" class="w-full bg-white/5 border border-white/10 p-4 rounded-xl text-white outline-none">
                        <input id="login-pass" type="password" placeholder="PASSCODE" class="w-full bg-white/5 border border-white/10 p-4 rounded-xl text-white outline-none">
                        <button onclick="loginOperative()" class="w-full bg-white text-black font-black py-4 rounded-full uppercase">Authorize</button>
                    </div>
                    <div id="director-login-portal" class="hidden pt-6 border-t border-gold/20 mt-6">
                        <input id="dir-pass" type="password" placeholder="BYPASS_KEY" class="w-full bg-black border border-gold/40 p-4 rounded-xl text-gold text-center font-black">
                        <button onclick="executeDirectorBypass()" class="w-full bg-gold text-black font-black p-4 rounded-full mt-2 uppercase text-[10px]">Access Totality</button>
                    </div>
                </section>

                <section class="command-tile h-64">
                    <div class="tile-header p-2 bg-black/40 border-b border-white/5 text-[8px] text-blue-400 font-black text-center uppercase">RSA Radar // Sector: eMalahleni</div>
                    <div class="w-full h-full radar-container">
                        <iframe width="100%" height="100%" frameborder="0" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d57434.34139824644!2d29.1925348!3d-25.8727196!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1e9447474400e46d%3A0xf6786c526713e71c!2seMalahleni!5e0!3m2!1sen!2sza!4v1710000000000!5m2!1sen!2sza"></iframe>
                    </div>
                </section>
            </div>
            
            <div class="lg:col-span-8 space-y-8">
                <section class="command-tile h-[500px] flex flex-col bg-black/40">
                    <div class="tile-header p-4 border-b border-white/5 flex justify-between">
                        <span class="text-white font-black text-xs uppercase">Frequency Comms</span>
                    </div>
                    <div id="chat-stream" class="flex-grow p-6 scroller-v flex flex-col"></div>
                    <div class="p-4 bg-black/80 flex gap-4">
                        <input type="text" id="chat-msg-in" placeholder="Transmit..." class="flex-grow bg-[#111] border border-white/10 rounded-full px-6 py-4 text-white">
                        <button onclick="sendPacket()" class="bg-blue-600 text-white rounded-full w-14 h-14 flex items-center justify-center"><i class="fa-solid fa-paper-plane"></i></button>
                    </div>
                </section>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <section class="command-tile h-[450px] flex flex-col border-red-600/20">
                        <div class="p-4 border-b border-white/5 bg-red-600/5 flex justify-between">
                            <span class="text-[9px] font-black text-red-500 uppercase">YT Frequency</span>
                            <i class="fa-brands fa-youtube text-red-600"></i>
                        </div>
                        <iframe class="flex-grow" src="https://www.youtube.com/embed/videoseries?list=PL4fGSI1pDJn6jXS_m5iK2v7r097Rq9Z_1" frameborder="0" allowfullscreen></iframe>
                    </section>
                    
                    <section class="command-tile h-[450px] flex flex-col border-gold/10">
                        <div class="p-4 border-b border-white/5 bg-gold/5 flex justify-between">
                            <span class="text-[9px] font-black text-gold uppercase">Sovereign Archive</span>
                            <div class="director-only">
                                <input type="file" id="archive-inject" class="hidden" onchange="uploadArchive(this)">
                                <button onclick="document.getElementById('archive-inject').click()" class="text-[8px] bg-gold/10 border border-gold px-3 py-1 rounded-full">INJECT</button>
                            </div>
                        </div>
                        <div class="flex-grow p-4 scroller-v space-y-3" id="archive-grid"></div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <script>
        const CFG = { U: "https://vbkpatwvgvwarybbpiky.supabase.co", K: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZia3BhdHd2Z3Z3YXJpYmJwaWt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExMjc0MTksImV4cCI6MjA4NjcwMzQxOX0.v3iWw2z9vL-X6pGjY0W_S5m1z0S8uI1L8yN7fL0M_Y8" };
        const db = window.supabase.createClient(CFG.U, CFG.K);
        let logoClicks = 0, isDirector = false;

        function toggleMenu() { document.getElementById('side-menu').classList.toggle('active'); }
        function openDirective() { document.getElementById('directive-modal').classList.remove('hidden'); }
        function closeDirective() { document.getElementById('directive-modal').classList.add('hidden'); }
        function handleLogoSequence() { logoClicks++; if (logoClicks === 5) { document.getElementById('director-login-portal').classList.remove('hidden'); logoClicks = 0; } }
        
        async function executeDirectorBypass() { 
            const p = document.getElementById('dir-pass').value; 
            if (p === '7486' || p === '@MOGProtocol2026') { 
                isDirector = true; document.documentElement.classList.add('director-active'); 
                document.getElementById('director-login-portal').classList.add('hidden');
                fetchArchive();
            } 
        }

        async function fetchArchive() {
            const { data } = await db.storage.from('archive').list('public');
            if (data) {
                document.getElementById('archive-grid').innerHTML = data.map((f, i) => {
                    const { data: { publicUrl } } = db.storage.from('archive').getPublicUrl(`public/${f.name}`);
                    const locked = f.name.toUpperCase().includes('LOCKED') && !isDirector;
                    return `<div class="track-row p-3 bg-white/5 rounded-xl flex items-center gap-3">
                        <i class="fa-solid fa-music text-zinc-500"></i>
                        <p class="flex-grow text-[9px] truncate uppercase">${f.name}</p>
                        <audio id="a-${i}" src="${publicUrl}"></audio>
                        ${locked ? '<span class="text-gold text-[8px] font-black">LOCKED</span>' : `<button onclick="document.getElementById('a-${i}').play()" class="text-emerald-500"><i class="fa-solid fa-play"></i></button>`}
                    </div>`;
                }).join('');
            }
        }

        function startCountdown() {
            const target = new Date("March 25, 2026 00:00:00").getTime();
            setInterval(() => {
                const now = new Date().getTime();
                const diff = target - now;
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);
                document.getElementById('timer').innerText = `${d}d ${h}h ${m}m ${s}s`;
            }, 1000);
        }

        async function sendPacket() {
            const input = document.getElementById('chat-msg-in');
            if(!input.value.trim()) return;
            await db.from('messages').insert([{ content: input.value, alias: "Operative" }]);
            input.value = "";
        }

        window.addEventListener('load', () => { 
            fetchArchive();
            startCountdown();
            setTimeout(() => { document.getElementById('startup-overlay').style.opacity = '0'; setTimeout(() => document.getElementById('startup-overlay').remove(), 1000); }, 1500);
        });
    </script>
</body>
</html>
